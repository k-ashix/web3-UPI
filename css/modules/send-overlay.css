/*
PHASE 8B — VISUAL OVERLAY REFINEMENT
DO NOT:
- Bind business logic
- Mutate send.js behavior
- Touch numeric logic
- Add APIs
This file is visual scaffolding only.
*/

/* ========================================
   OVERLAY CONTAINER
   Anchored relative to .app-container (which is full screen)
======================================== */
.selection-overlay-container {
    position: absolute;
    /* Top offset increased to ensure pills are ALWAYS visible (Fix #1) */
    /* 172px + 34px buffer = 206px */
    top: 206px;
    left: 0;
    right: 0;
    bottom: 0;
    /* Extend to bottom edge */
    z-index: 100;
    /* Layer above send card content */

    /* Layout */
    display: flex;
    flex-direction: column;
    overflow: hidden;

    /* Glass Material (Stronger Blur) */
    background: rgba(255, 255, 255, 0.4);
    /* Reduced opacity for more glass feel */
    background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.85));
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);

    /* Shape */
    border-radius: 20px 20px 0 0;
    /* Only top rounded */
    box-shadow: 0 -4px 30px rgba(0, 0, 0, 0.08);

    /* Animation */
    opacity: 0;
    transform: translateY(100%);
    /* Slide form bottom roughly */
    pointer-events: none;
    transition: opacity 0.25s cubic-bezier(0.22, 1, 0.36, 1), transform 0.25s cubic-bezier(0.22, 1, 0.36, 1);
}

.selection-overlay-container.active {
    opacity: 1;
    transform: translateY(0);
    pointer-events: auto;
}

/* ========================================
   HEADER SECTION
======================================== */
.overlay-header {
    padding: 1.2rem 1.5rem 0.8rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    /* Subtle separation */
    border-bottom: 1px solid rgba(255, 255, 255, 0.3);
    background: rgba(255, 255, 255, 0.2);
    flex-shrink: 0;
}

.overlay-title {
    font-family: var(--font-serif);
    font-size: 1.1rem;
    font-weight: 700;
    color: #1a1a1a;
    letter-spacing: -0.01em;
}

.overlay-subtitle {
    font-family: var(--font-sans);
    font-size: 0.75rem;
    color: #666;
    margin-top: 2px;
}

/* ========================================
   SCROLLABLE LIST
======================================== */
.overlay-list {
    flex: 1;
    overflow-y: auto;
    padding: 1rem 1.2rem;
    /* Increased side padding */
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
    /* Increased gap */

    /* Hide scrollbar */
    scrollbar-width: none;

    /* Native Scroll Isolation */
    overscroll-behavior: contain;
}

.overlay-list::-webkit-scrollbar {
    display: none;
}

/* Bottom safe padding */
.overlay-list::after {
    content: '';
    display: block;
    height: 100px;
    flex-shrink: 0;
}

/* ========================================
   SECTION HEADERS (Soft)
======================================== */
.overlay-section-header {
    font-family: var(--font-sans);
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: #888;
    margin-top: 1rem;
    margin-bottom: 0.4rem;
    padding-left: 0.4rem;
}

.overlay-section-header:first-child {
    margin-top: 0.2rem;
}

/* ========================================
   CARD ITEM (Premium Density)
======================================== */
.overlay-card-item {
    display: flex;
    align-items: center;
    padding: 1rem 1rem;
    /* Increased padding */
    border-radius: 18px;
    background: rgba(255, 255, 255, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.4);
    cursor: pointer;
    transition: all 0.2s ease-out;
    position: relative;
    overflow: hidden;
}

.overlay-card-item:hover {
    background: rgba(255, 255, 255, 0.65);
    transform: scale(1.01);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03);
    border-color: rgba(255, 255, 255, 0.8);
}

.overlay-card-item:active {
    transform: scale(0.98);
    background: rgba(255, 255, 255, 0.75);
}

.overlay-card-item.disabled {
    opacity: 0.4;
    pointer-events: none;
    filter: grayscale(1);
}

/* ========================================
   ICON PLACEHOLDER (Legacy - kept for compatibility)
======================================== */
.card-icon-placeholder {
    width: 40px;
    /* Fixed Geometry */
    height: 40px;
    border-radius: 50%;
    background: rgba(0, 0, 0, 0.05);
    /* Neutral grey */
    margin-right: 14px;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid rgba(0, 0, 0, 0.02);
}

/* ========================================
   ICON IMAGE (Primary Visual)
======================================== */
.card-icon-img {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
    margin-right: 12px;
    flex-shrink: 0;
    /* Ensure img is always visible */
    display: block;
    position: relative;
    z-index: 1;
    /* Fallback background - only visible when img fails */
    background: rgba(200, 200, 200, 0.2);
}

/* Fallback placeholder for failed icons */
.card-icon-img::after {
    content: '?';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 14px;
    color: rgba(0, 0, 0, 0.3);
    font-weight: 600;
    z-index: 0;
    opacity: 0;
    pointer-events: none;
}

/* Show placeholder when img fails */
.card-icon-img[data-icon-failed="true"]::after {
    opacity: 1;
}

/* ========================================
   CARD INFO
======================================== */
.card-info {
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.card-name {
    font-family: var(--font-sans);
    font-size: 0.95rem;
    font-weight: 600;
    color: #222;
    margin-bottom: 2px;
}

.card-tag {
    font-size: 0.7rem;
    color: #777;
    background: transparent;
    padding: 0;
    margin: 0;
}

/* ========================================
   THEME INTEGARTION (CSS-Only / Passive)
   Uses :has() to detect parent state
======================================== */

/* ETH Style */
.app-container:has(.theme-eth) .selection-overlay-container {
    background-image: linear-gradient(to bottom, rgba(230, 240, 255, 0.7), rgba(255, 255, 255, 0.9));
}

.app-container:has(.theme-eth) .selection-overlay-container .overlay-card-item:hover {
    border-color: rgba(122, 159, 255, 0.3);
    background: rgba(240, 245, 255, 0.7);
}

.app-container:has(.theme-eth) .selection-overlay-container .card-icon-placeholder {
    background: rgba(122, 159, 255, 0.1);
}

/* BTC Style */
.app-container:has(.theme-btc) .selection-overlay-container {
    background-image: linear-gradient(to bottom, rgba(255, 248, 235, 0.7), rgba(255, 255, 255, 0.9));
}

.app-container:has(.theme-btc) .selection-overlay-container .overlay-card-item:hover {
    border-color: rgba(255, 183, 101, 0.3);
    background: rgba(255, 250, 240, 0.7);
}

.app-container:has(.theme-btc) .selection-overlay-container .card-icon-placeholder {
    background: rgba(255, 183, 101, 0.1);
}

/* SOL Style */
.app-container:has(.theme-sol) .selection-overlay-container {
    background-image: linear-gradient(to bottom, rgba(245, 240, 255, 0.7), rgba(255, 255, 255, 0.9));
}

.app-container:has(.theme-sol) .selection-overlay-container .overlay-card-item:hover {
    border-color: rgba(153, 69, 255, 0.3);
    background: rgba(250, 245, 255, 0.7);
}

.app-container:has(.theme-sol) .selection-overlay-container .card-icon-placeholder {
    background: rgba(153, 69, 255, 0.1);
}

/* ========================================
   PHASE 14 — BITCOIN TRANSFER MODE (VISUAL ONLY)
   Inline expandable UI inside BTC asset row
======================================== */

/* Chevron Button */
.btc-mode-chevron {
    margin-left: auto;
    padding: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    border-radius: 50%;
    transition: all 0.2s ease-out;
    color: #666;
    background: rgba(0, 0, 0, 0.03);
}

.btc-mode-chevron:hover {
    background: rgba(0, 0, 0, 0.08);
    color: #333;
}

.btc-mode-chevron i {
    font-size: 0.85rem;
    transition: transform 0.25s cubic-bezier(0.22, 1, 0.36, 1);
}

/* Rotate chevron when expanded */
.overlay-card-item.btc-expanded .btc-mode-chevron i {
    transform: rotate(180deg);
}

/* Mode Container (Hidden by default) */
.btc-mode-container {
    max-height: 0;
    overflow: hidden;
    opacity: 0;
    transition: max-height 0.3s cubic-bezier(0.22, 1, 0.36, 1),
        opacity 0.25s ease-out,
        margin 0.25s ease-out;
    margin: 0;
}

.btc-mode-container.btc-expanded {
    max-height: 300px;
    /* Enough for 3 pills */
    opacity: 1;
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
}

/* Pills Container */
.btc-mode-pills {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    padding: 0 0.5rem;
}

/* Individual Mode Pill */
.btc-mode-pill {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.85rem 1rem;
    border-radius: 14px;
    background: rgba(255, 255, 255, 0.4);
    border: 1px solid rgba(255, 183, 101, 0.2);
    cursor: pointer;
    transition: all 0.2s ease-out;
    font-family: var(--font-sans);
    font-size: 0.88rem;
    font-weight: 500;
    color: #333;
}

.btc-mode-pill:hover {
    background: rgba(255, 250, 240, 0.7);
    border-color: rgba(255, 183, 101, 0.4);
    transform: translateX(4px);
    box-shadow: 0 2px 8px rgba(255, 183, 101, 0.15);
}

.btc-mode-pill:active {
    transform: translateX(2px) scale(0.98);
}

.btc-mode-pill i {
    font-size: 1rem;
    color: #f7931a;
    /* Bitcoin orange */
    flex-shrink: 0;
}

.btc-mode-pill span:first-of-type {
    flex: 1;
}

/* Recommended Badge */
.btc-mode-badge {
    font-size: 0.65rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.03em;
    padding: 0.25rem 0.6rem;
    border-radius: 8px;
    background: rgba(255, 183, 101, 0.15);
    color: #f7931a;
    border: 1px solid rgba(255, 183, 101, 0.25);
}

/* First pill (Taproot) - highlight as recommended */
.btc-mode-pill:first-child {
    border-color: rgba(255, 183, 101, 0.35);
    background: rgba(255, 250, 240, 0.5);
}

.btc-mode-pill:first-child:hover {
    border-color: rgba(255, 183, 101, 0.5);
    background: rgba(255, 250, 240, 0.85);
}

/* ========================================
   PHASE 15 — ACTIVE STATE (LOCAL UI ONLY)
======================================== */

/* Active pill state - visually selected */
.btc-mode-pill.active {
    background: rgba(255, 250, 240, 0.9);
    border-color: rgba(247, 147, 26, 0.6);
    border-width: 2px;
    box-shadow: 0 2px 12px rgba(247, 147, 26, 0.2),
        inset 0 1px 3px rgba(247, 147, 26, 0.1);
    transform: translateX(2px);
}

.btc-mode-pill.active:hover {
    background: rgba(255, 250, 240, 0.95);
    border-color: rgba(247, 147, 26, 0.7);
    transform: translateX(4px);
}

/* Active pill icon - brighter */
.btc-mode-pill.active i {
    color: #d97706;
    color: #d97706;
}

/* Active pill badge - enhanced */
.btc-mode-pill.active .btc-mode-badge {
    background: rgba(247, 147, 26, 0.25);
    border-color: rgba(247, 147, 26, 0.4);
    color: #d97706;
}

/* ========================================
   [PHASE 17] SELECTION VISUAL FEEDBACK
   ======================================== */

/* Selected Card Highlight */
.overlay-card-item.selected {
    background: rgba(255, 255, 255, 0.75);
    border-color: rgba(0, 0, 0, 0.8);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

/* Theme Awareness for Selected State */
.app-container:has(.theme-eth) .selection-overlay-container .overlay-card-item.selected {
    border-color: rgba(98, 126, 234, 0.8);
    background: rgba(230, 240, 255, 0.9);
}

.app-container:has(.theme-btc) .selection-overlay-container .overlay-card-item.selected {
    border-color: rgba(247, 147, 26, 0.8);
    background: rgba(255, 248, 235, 0.9);
}

.app-container:has(.theme-sol) .selection-overlay-container .overlay-card-item.selected {
    border-color: rgba(20, 241, 149, 0.8);
    background: rgba(245, 240, 255, 0.9);
}

/* Checkmark Icon */
.card-checkmark {
    margin-left: auto;
    color: #000;
    font-size: 1rem;
    padding-right: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
}

.app-container:has(.theme-eth) .card-checkmark {
    color: #627eea;
}

.app-container:has(.theme-btc) .card-checkmark {
    color: #f7931a;
}

.app-container:has(.theme-sol) .card-checkmark {
    color: #14f195;
}

/* Adjustments for BTC Mode Controls when selected */
/* Force card-info to grow to push everything else right */
.card-info {
    flex: 1;
}

/* Checkmark placement */
.card-checkmark {
    margin-left: 0.5rem;
    margin-right: 0.5rem;
}

/* If BTC controls exist, checkmark is between Info and Chevron. */